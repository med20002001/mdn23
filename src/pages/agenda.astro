---
import Layout from "../layouts/Layout.astro";
import CalendarDropdown from "../components/CalendarDropdown.tsx";

const events = [
  {
    month: "AVR",
    day: "21",
    year: "2024",
    date: new Date("2024-04-21"),
    datetime: "avril 21, 2024 @ 4:00 pm - 6:30 pm",
    title: "Musica Mundo Series",
    location: "Théâtre De Lieve Vrouw Lieve Vrouwestraat 13, Amersfoort",
    description: "Hamid Bouchnak & L'orchestre Andalou d'Amsterdam La star marocaine et l'orchestre donnent une nouvelle dimension à la musique andalouse et au raï...",
    image: "/images/events/event1.jpg",
    href: "/agenda/musica-mundo",
  },
  {
    month: "MAR",
    day: "14",
    year: "2024",
    date: new Date("2024-03-14"),
    datetime: "mars 14, 2024 @ 12:00 pm - 1:15 pm",
    title: "Architecture en mutation: Réinventer l'approche opérationnelle",
    location: "Sfeir Lille 74 Rue des Arts, Lille",
    description: "Détails En mars, nous avons le plaisir d'accueillir deux speakers ! Et comme d'habitude, même endroit, même heure !...",
    image: "/images/events/event2.jpg",
    href: "/agenda/architecture-mutation",
  },
  {
    month: "MAR",
    day: "9",
    year: "2024",
    date: new Date("2024-03-09"),
    datetime: "mars 9, 2024 @ 5:00 pm - 7:00 pm",
    title: "Dia Internacional De La Dona",
    location: "Museo de Gavà - Torre Lluch Plaça de Dolors Clua, 13, Gavà",
    description: "Celebrem i reconeixem el paper essencial de les dones en la construcció d'una societat igualitària...",
    image: "/images/events/event3.jpg",
    href: "/agenda/dia-internacional",
  },
  {
    month: "FEV",
    day: "28",
    year: "2024",
    date: new Date("2024-02-28"),
    datetime: "février 28, 2024 @ 4:00 pm - 6:00 pm",
    title: "Invitation Cérémonie de Signature",
    location: "AMPCC 27 Rue Abdelfattah Sebata, Rabat, Morocco",
    description: "Déclaration d'intention Amiens Métropole - Ville de Nador Participants : Alain Gest - Président d'Amiens Métropole Slimane Azouarghe - Maire de la Ville de Nador Salaheddine El Manouzi - Président...",
    image: "/images/events/event4.jpg",
    href: "/agenda/Invitation-Cérémonie-de-Signature",
  },
    {
    month: "MAR",
    day: "6",
    year: "2024",
    date: new Date("2024-03-03"),
    datetime: "mars 6, 2024 - mars 8, 2024",
    title: "La diplomatie culturelle, mécanisme de dialogue interculturel",
    location: "HOTEL KENZI SOLAZUR 168 Boulevard Mohamed VI, Tanger, Morocco",
    description: "Action commune FAL inter-réseaux La diplomatie culturelle, mécanisme de dialogue interculturel",
    image: "/images/events/event6.jpg",
    href: "/agenda/La-diplomatie-culturelle",
  },
    {
    month: "MAR",
    day: "3",
    year: "2024",
    date: new Date("2024-03-03"),
    datetime: "mars 3, 2024 @ 11:00 am - 3:00 pm",
    title: "Rencontres By ME",
    location: "hôtel Kube 1 passage Ruelle, Paris, France",
    description: "Partage d'expériences entrepreneuriales & Networking Les rencontres by ME sont de retour ! Et si on se retrouvait autour d'un brunch débat dimanche 3 mars prochain ? L'équipe Maroc Entrepreneurs a le...",
    image: "/images/events/event5.jpg",
    href: "/agenda/Rencontres-By-ME",
  },
];

// Date actuelle
const now = new Date();

// Séparer événements passés et à venir
const upcomingEvents = events
  .filter(event => event.date >= now)
  .sort((a, b) => a.date.getTime() - b.date.getTime()); // Tri croissant (du plus proche au plus loin)

const pastEvents = events
  .filter(event => event.date < now)
  .sort((a, b) => b.date.getTime() - a.date.getTime()); // Tri décroissant (du plus récent au plus ancien)
---

<Layout title="Agenda">
  <main class="bg-white min-h-screen">
    <!-- Barre de recherche et onglets -->
    <div class="border-b border-gray-200">
      <div class="max-w-6xl mx-auto px-4 py-4 flex flex-wrap items-center justify-between gap-4">
        <div class="flex items-center gap-2">
          <input
            type="text"
            placeholder="Rechercher évènements"
            class="border border-gray-300 rounded px-3 py-2 text-sm w-64 focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
          <button
            class="px-4 py-2 text-sm font-medium text-white rounded"
            style="background-color: #4f46e5;"
          >
            Chercher
          </button>
        </div>
        <div class="flex items-center gap-4 text-sm text-gray-600">
          <a href="#" class="hover:text-gray-900 border-b-2 border-blue-600 pb-1">Liste</a>
          <a href="#" class="hover:text-gray-900">Mois</a>
          <a href="#" class="hover:text-gray-900">Jour</a>
        </div>
      </div>
    </div>

    <!-- Navigation calendrier avec dropdown -->
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center gap-4 text-sm">
      <button class="text-gray-500 hover:text-gray-900">&lt;</button>
      <button class="text-gray-500 hover:text-gray-900">&gt;</button>
      <button class="border border-gray-300 rounded px-3 py-1 text-gray-700 hover:bg-gray-50">
        Aujourd'hui
      </button>
      <CalendarDropdown client:load />
    </div>

    <!-- Section Événements à venir -->
    {upcomingEvents.length > 0 ? (
      <section class="max-w-6xl mx-auto px-4 py-10">
        <h2 class="text-2xl font-bold text-gray-900 mb-8">
          Événements à venir
        </h2>

        <div class="space-y-8">
          {upcomingEvents.map((event, index) => (
            <article class="grid grid-cols-1 md:grid-cols-[80px_1fr_320px] gap-6 border-t border-gray-200 pt-8">
              <div class="text-center md:text-left">
                <p class="text-xs uppercase text-blue-700 font-medium">{event.month}</p>
                <p class="text-3xl font-bold text-gray-900">{event.day}</p>
                <p class="text-xs text-gray-500">{event.year}</p>
              </div>
              <div>
                <p class="text-sm text-gray-500 mb-1">{event.datetime}</p>
                <a href={event.href} class="text-lg font-bold text-gray-900 hover:text-blue-700 block mb-2">
                  {event.title}
                </a>
                <p class="text-sm text-gray-600 mb-3">{event.location}</p>
                <p class="text-sm text-gray-600 leading-relaxed">{event.description}</p>
              </div>
              <div class="hidden md:block">
                {event.title === "Dia Internacional De La Dona" ? (
                  <div class="w-full max-w-sm mx-auto rounded overflow-hidden shadow-md">
                    <img 
                      src={event.image} 
                      alt={event.title} 
                      class="w-full h-auto object-contain" 
                      loading="lazy" 
                    />
                  </div>
                ) : (
                  <img 
                    src={event.image} 
                    alt={event.title} 
                    class="w-full h-44 object-cover rounded" 
                    loading="lazy" 
                  />
                )}
              </div>
            </article>
          ))}
        </div>
      </section>
    ) : (
      <!-- Message "pas d'évènements à venir" -->
      <div class="max-w-6xl mx-auto px-4 py-10">
        <div class="bg-gray-100 border-t-4 border-blue-600 py-3 px-4 text-sm text-gray-600 text-center">
          Il n'y a pas d'évènements à venir.
        </div>
      </div>
    )}

    <!-- Section Derniers Événements passés -->
    {pastEvents.length > 0 && (
      <section class="max-w-6xl mx-auto px-4 py-10">
        <h2 class="text-2xl font-bold text-gray-900 mb-8">
          Derniers Événements passés
        </h2>

        <div class="space-y-8">
          {pastEvents.map((event, index) => (
            <article class="grid grid-cols-1 md:grid-cols-[80px_1fr_320px] gap-6 border-t border-gray-200 pt-8">
              <div class="text-center md:text-left">
                <p class="text-xs uppercase text-blue-700 font-medium">{event.month}</p>
                <p class="text-3xl font-bold text-gray-900">{event.day}</p>
                <p class="text-xs text-gray-500">{event.year}</p>
              </div>
              <div>
                <p class="text-sm text-gray-500 mb-1">{event.datetime}</p>
                <a href={event.href} class="text-lg font-bold text-gray-900 hover:text-blue-700 block mb-2">
                  {event.title}
                </a>
                <p class="text-sm text-gray-600 mb-3">{event.location}</p>
                <p class="text-sm text-gray-600 leading-relaxed">{event.description}</p>
              </div>
              <div class="hidden md:block">
                {event.title === "Dia Internacional De La Dona" ? (
                  <div class="w-full max-w-sm mx-auto rounded overflow-hidden shadow-md">
                    <img 
                      src={event.image} 
                      alt={event.title} 
                      class="w-full h-auto object-contain" 
                      loading="lazy" 
                    />
                  </div>
                ) : (
                  <img 
                    src={event.image} 
                    alt={event.title} 
                    class="w-full h-44 object-cover rounded" 
                    loading="lazy" 
                  />
                )}
              </div>
            </article>
          ))}
        </div>
      </section>
    )}
  </main>
</Layout>
